---
layout: post
title: "JavaScriptのスコープについて"
date:  2014-08-02 15:42
---

スコープとは、変数が参照可能な範囲のことである。

変数の参照には二つの種類があり、一つは値を変数に割り当てる参照（これをLHS - Left Hand Side 参照という）、もう一つは変数から値を取得する参照（これをRHS - Right Hand Side 参照という）である。

例えば、`var a = 2;`というコードを実行するとき、内部では以下の二つのステップに分割されている。

1. `var a`によって、スコープ内に変数を宣言する。この処理はコードが実行される前に行われる。
2. `a = 2`によって、変数への参照（LHS参照）が行われる。もし変数が宣言されていれば、変数に値が代入される。

LHS参照とRHS参照はともに、その参照が実行されているスコープから始まり、もし参照しようとした変数が見つからない場合、そのスコープの外側のスコープ（親のスコープ）で同様に参照を続ける。この参照を、最も外側のスコープ（グローバルスコープ）まで繰り返していく。

もし、RHS参照時に変数が見つからなければ`ReferenceError`例外が発生する。いっぽう、LHS参照時に変数が見つからない場合、コンパイラは自動的にグローバル変数を作成する（ただしStrict Mode - `use strict`使用時の場合はRHS参照と同様に`ReferenceError`となる）。

以下は、LHS参照とRHS参照の例。

```js
function foo(a) {
  var b = a;
  return a + b;
}

var c = foo(2);
```

LHS参照は、`c = ..`、`a = 2`、`b = ..`の計三つであるのに対し、RHS参照は`foo(2..`、`= a;`、`a + ..`、`.. + b`の計四つがある。